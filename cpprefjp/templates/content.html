{% extends "base.html" %}
{% block brand %}{{ brand|e }}{% endblock %}
{% block title %}{{ title|e }}{% endblock %}

{% block rss %}
  <link rel="alternate" type="application/atom+xml" title="Atom" href="{{ rss }}" />
{% endblock %}

{% block edit_url %}{{ edit_url }}{% endblock %}
{% block history_url %}{{ history_url }}{% endblock %}

{% macro sidebar_tree(children, parent_opened) %}
  {% for child in children %}
    {% if child.is_node %}
      <li {{ 'style="display: none"' if not parent_opened }} class="parent_li {{ 'active' if child.opened }}">
        <span onclick="tree_onclick.call(this, event)"><i class="glyphicon {{ 'glyphicon-minus' if child.opened else 'glyphicon-plus' }}"></i></span>
        {% if child.href %}
          <a href="{{ child.href }}">{{ child.title|e }}</a>
        {% else %}
          {{ child.title|e }}
        {% endif %}
        <ul>
          {{ sidebar_tree(child.children, child.opened) }}
        </ul>
      </li>
    {% else %}
      <li {{ 'style="display: none"' if not parent_opened }}>
        {% if child.href %}
          <a href="{{ child.href }}">{{ child.title|e }}</a>
        {% else %}
          {{ child.title|e }}
        {% endif %}
      </li>
    {% endif %}
  {% endfor %}
{% endmacro %}

{% block sidebar %}
<div class="tree">
  <ul>
    {{ sidebar_tree(sidebar.children, True) }}
  </ul>
</div>
{% endblock %}

{% block content_header %}
  <ol class="breadcrumb">
    {% for header in content_header.headers %}
      <li {{ 'class="active"' if header.is_active }}>
        {% if not header.is_active and header.href %}
          <a href="{{ header.href }}">{{ header.title|e }}</a>
        {% else %}
          {{ header.title|e }}
        {% endif %}
      </li>
    {% endfor %}
  </ol>
{% endblock %}

{% block project %}
  <a href="{{ project_url }}">{{ project_name }}</a>
{% endblock %}
{% block body %}
  {{ body|safe }}
{% endblock %}

{% block search %}
  {{ search|safe }}
{% endblock %}

{% block analytics %}
  {{ analytics|safe }}
{% endblock %}

{% block keywords %}
  {{ keywords|safe }}
{% endblock %}

{% block latest_commit_info %}
  <p class="text-right"><small>
    最終更新日時: {{ latest_commit_info['last_updated'].strftime('%Y年%m月%d日 %H時%M分%S秒'.encode('utf-8')).decode('utf-8') }}<br/>
    {{ latest_commit_info['last_author'] }} が更新
  </small></p>
{% endblock %}
